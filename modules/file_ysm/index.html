<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诊所Excel分割工具</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="app-container">
            <div class="header">
                <h1>诊所Excel分割工具</h1>
                <p class="text-muted">按诊所名称分割Excel文件</p>
            </div>
            
            <div id="alertContainer"></div>
            
            <div class="instructions">
                <p>请选择要处理的Excel文件，程序将按诊所分组生成单独的Excel文件。</p>
                <p>注意：Excel文件必须包含一个包含"诊所"字样的列。</p>
            </div>
            
            <div class="upload-form">
                <div class="mb-3">
                    <label for="billingMonth" class="form-label">对账月</label>
                    <input type="text" class="form-control" id="billingMonth" placeholder="例如：2023年6月">
                </div>
                <div class="mb-3">
                    <label for="excelFile" class="form-label">选择Excel文件</label>
                    <input class="form-control" type="file" id="excelFile" accept=".xlsx,.xls">
                </div>
                <div class="d-grid gap-2">
                    <button id="processButton" type="button" class="btn btn-primary">开始处理</button>
                </div>
            </div>
            
            <div class="progress-section mt-4" style="display: none;">
                <div class="progress">
                    <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                </div>
                <p id="statusText" class="text-center mt-2">准备处理...</p>
            </div>
            
            <div class="log-section mt-4">
                <h5>处理日志</h5>
                <div class="log-container">
                    <div id="logContent" class="log-content"></div>
                </div>
            </div>
            
            <div id="resultSection" class="result-section mt-4" style="display: none;">
                <h4>处理结果</h4>
                <p id="resultSummary"></p>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>诊所名称</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="resultTable">
                            <!-- 结果将在这里动态添加 -->
                        </tbody>
                    </table>
                </div>
                <div class="text-center mt-3">
                    <button id="downloadAllButton" class="btn btn-success">下载所有文件 (ZIP)</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 引入必要的JavaScript库 -->
    <script src="js/xlsx.full.min.js"></script>
    <script src="js/FileSaver.min.js"></script>
    <script src="js/jszip.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <!-- 在其他 script 标签之前添加 ExcelJS 库 -->
    <script src="js/exceljs.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>